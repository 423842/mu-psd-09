# テスト仕様書: Flask + OpenRouter AI チャットアプリ

## 1. テスト対象
- `app.py`（Flaskサーバー/APIバックエンド）
- `frontend\src\App.vue`（フロントエンドUI）

## 2. テスト環境
- Windows 10/11
- Python 3.11
- VITE 5.4.19
- ffmpeg 8.0
- npm 10.9.3
- node 22.19.0
- Flask, venv
- Whisperモデル： `small`
- 感情分析モデル： `koshin2001/Japanese-to-emotions`
- ブラウザ: Chrome, Edge

## 3. テスト項目

### 3.1. サーバー起動
| No | テスト内容 | 手順 | 期待結果 |
|----|------------|------|----------|
| 1  | 仮想環境起動 | `venv\Scripts\activate`で起動 | プロンプトの左側に仮想環境名が表示される |
| 2  | Flaskサーバー起動 | `python app.py`で起動 | Debugger PINが表示される |
| 3  | 開発サーバー起動 | `npm run dev`で起動 | http://localhost:5173/ にアクセスするとアプリが起動できる |

### 3.2. UIテスト
| No | テスト内容 | 手順 | 期待結果 |
|----|------------|------|----------|
| 4 | タブの選択 |  | タブが変更できる |
| 5 | ファイルのアップロード | タブ：WAVファイル 「ファイルの選択」をクリック | ファイルがアップロードできる |
| 6 | WAVファイルの解析1 | タブ：WAVファイル ファイルアップロード前 | 「アップロードして解析」はクリックできない |
| 7 | WAVファイルの解析2 | タブ：WAVファイル ファイルアップロード後 「アップロードして解析」をクリック | 解析中…と表示される |
| 8 | WAVファイルの解析3 | タブ：WAVファイル WAVファイル以外のファイルをアップロード | 「WAVファイル以外のファイルは解析できません」と表示し、ファイルをクリア |
| 9 | 解析結果1 | タブ：WAVファイル 音声の記録されたWAVファイルをアップロード | (WAVファイル名).wavの解析結果として、感情のサマリー、感情スコアが表示される |
| 10 | 解析結果2 | タブ：WAVファイル 音声の記録されていないWAVファイルをアップロード | (WAVファイル名).wavの解析結果として、「音声が入力されていません」と表示される |
| 11 | 解析結果3 | タブ：WAVファイル WAVファイルの解析中にタブを移動、解析終了までに元のタブに戻らない | 別のタブでも解析中…と表示されるが、結果は表示されない |
| 12 | 解析結果4 | タブ：WAVファイル WAVファイルの解析中にタブを移動、解析終了までに元のタブに戻る | No.9,No.10と同じ動作 |
| 13 | 解析後に再度解析1 | タブ：WAVファイル 解析後に別のファイルの解析を行う | ファイルをアップロードした時点で結果をクリア |
| 14 | クリア1 | 解析完了後に タブ：WAVファイル から タブ：音声を録音 に移動 | 結果、アップロードしたファイルをクリア。以降No.7かNo.8と同じ動作 |
| 15 | クリア2 | ファイルをアップロードした状態で タブ：WAVファイル から タブ：音声を録音 に移動 | アップロードしたファイルをクリア |
| 16 | 音声の録音1 | タブ：音声を録音 「録音開始」をクリック | 3秒間のカウントダウンの後、録音が開始 |
| 17 | 音声の録音2 | タブ：音声を録音 録音が開始してから10秒以内に「録音停止」をクリックする | 録音が停止 |
| 18 | 音声の録音3 | タブ：音声を録音 録音が開始してから「録音停止」をクリックしない | 録音を開始してから10秒後、自動で録音停止 |
| 19 | 音声の録音4 | タブ：音声を録音 「録音開始」をクリックしてから録音が停止するまで | 「録音開始」はクリックできない |
| 20 | 音声の録音5 | タブ：音声を録音 録音を開始していない状態 | 「録音停止」はクリックできない |
| 21 | 音声の録音6 | タブ：音声を録音 「録音開始」をクリックしてから録音が停止するまでにタブを移動 | 録音が中断される |
| 22 | 録音した音声の解析 | タブ：音声を録音 録音完了後、「解析」をクリック | 解析中…と表示される |
| 23 | 解析結果5 | タブ：音声を録音 音声の録音して解析 | 録音した音声の解析結果として、感情のサマリー、感情スコアが表示される |
| 24 | 解析結果6 | タブ：音声を録音 無音の録音を解析 | 録音した音声の解析結果として、「音声が入力されていません」と表示される |
| 25 | 解析結果7 | タブ：音声を録音 録音した音声の解析中にタブを移動、解析終了までに元のタブに戻らない | 別のタブでも解析中…と表示されるが、結果は表示されない |
| 26 | 解析結果8 | タブ：音声を録音 録音した音声の解析中にタブを移動、解析終了までに元のタブに戻る | No.23,No.24と同じ動作 |
| 27 | 解析後に再度解析2 | タブ：音声を録音 解析後に再度録音して解析を行う | 録音が開始した時点で結果をクリア |
| 28 | クリア3 | タブ：音声を録音 録音完了後にタブを移動 | 録音した音声をクリア |
| 29 | クリア4 | タブ：音声を録音 解析完了後にタブを移動 | 結果と録音した音声をクリア |

## 4. その他
- WAVファイルの入力最大長の確認
- 無音ではないが音声の入っていないWAVファイル、録音（無音声の曲）の結果の確認
- レスポンス速度の目安計測
- CORS確認

---
